# Parameter Error Task Scripts/Settings

## Settings_and_GroundTruth directory:

This contains the settings csv's that define the parameters used for each index of the parameter sweeps in the parameter task. It is also where the ground truth trajectories are stored once generated.

## Generate_Ground_Truth_Kuramoto.jl

File to generate the ground truth trajectories for each dynamical regime of the standard kuramoto system. Uses the phase component form (x, y on the unit circle, rather than phases). The trajectories will be stored as compressed arrow files in the Settings_and_GroundTruth directory. Takes command line arguments to define the regime desired, and optionally to modify the input (where the settings files are) and output directories. Assuming the input/output directories are left as is, one can run this by calling "julia ./Parameter_Error_Task/Generate_Ground_Truth_Kuramoto.jl <regime_number>" where <regime_number> is 1, 2, or 3 to generate the asynchronous, multi-frequency, and synchronous regimes respectively. Three instantiations of each regime will be generated, labelled _0, _1, and _2, with varying parameters but the same qualitative dynamics as used in the paper. The trajectories are 62001x10 matrices, corresponding to the 5 oscillators (10 phase components) and 6200 second length with dt=0.1), generally they are permuted before use in the downstream scripts, but not before plotting.

Due to the use of a default random seed in the definition of the multi-frequency regime, these trajectories will vary slightly from those used to generate the results in the paper. 

## Task1_ParameterSweep.jl

Designed to be run using a SLURM job-array script, this runs an evaluation for a particular parameter at a particular index of its sweep. It takes command line arguments to define the sweep index (1-20), the parameter sweep name (i.e. 'SpectralRadius', see settings csv file titles for appropriate names), the 'base model' or ground truth regime, (2, 7, or 16 for asynchronous, multi-frequency, and synchronous respectively), and the 'eval type' specifying the model to make the predictions with ("ODE", "Standard", and "Hybrid"). Example command line call is: "julia ./Parameter_Error_Task/Task1_ParameterSweep 9 InputScaling 7 Hybrid" which would test the hybrid reservoir using parameters corresponding to the 9th index of the Input Scaling sweep on the multi-frequency regime. To note, you can just run the ODE model over the KError, KErrorLarge, OmegaError, OmegaErrorLarge, and MeanDegree sweeps, as the MeanDegree result will be used for all parameters unique to the reservoirs (see plot script advice).

It will instantiate 40 ODEs parameter sets (with error), or 40 reservoirs depending on the eval type, and train and test each over the 20 test segments of the ground truth trajectories for each of the three variants of the particular regime.  It will output csvs containing the mean normalised error of each reservoir's prediction for each test segment in a 20x40 array, one for each of the regime variants (3). There is an option, 'save_trajectories', to decide whether to output compressed arrow files containing all predicted trajectories for further analysis (this will take up a lot of space for all of the sweeps - around 600GB). Output data will be stored in directories specific to the parameter sweep within the Parameter_Error_Task directory.

Due to the use of a default random see for the multi-frequency variant parameter generation, AND for the multiplicative error generation (used on the ODE's parameters and for the expert model's parameters in the hybrid reservoir), exact trajectories and performance will vary slightly, but not substantially from the reported results.

## Plot_Task1_ParameterSweep.jl

Generates Figure 8 (the spectral radius and input scaling sweep results), as well as parameter sweep specific figures containing the results across all models and ground truth regimes as in the Supplementary figures S1-S7. It is currently configured to generate all of these figures at once, but can be modified to specify a particular sweep, or to plot with reduced data by modifying the 'arrayindex_range' (to plot across a shorter sweep than 1 to 20), the 'test_num_range' (if you have produced a set of results testing with less than 20 tests for each regime variant, baseline is 60, 20 for each regime), and the 'num_reservoirs' (if you ran with reduced reservoir/ODE instantiations from the baseline 40). The section at the end saves the figures, if you want to plot a single regime, the final plot definition indexes from the saved plots ('subplot_collection') using [i+20, i, i+10] corresponding to the synchronous, multi-frequency, and asynchronous regimes for the i'th parameter sweep (i is in 1:10). This must be changed to draw just the i'th index, as the other regimes will not have been saved. To plot specific model types, line 39 can be changed such that 'models' contains only the models you want to plot, note the colors defined in the line below will also need changing. The plot creation will use the MeanDegree results of the ODE simulations for all other parameter sweeps that do not impact the ODE model to save space (i.e. you do not need to run the ODE model across the ReservoirSize sweep!). The plot x labels are defined in the 'parameters_sweep_names' vector, whose order must correspond to the order in the 'parameters_to_plot' vector. The second half of the main plot loop (line 33, looping over regimes) plots the combined spectral radius, and Input scaling + inputscalinglarge results in Figure 8. 

## Plot_Task1_Trajectories.jl

Plot and save example trajectories from a particular parameter sweep index and ground truth regime as in the supplementary information S8-S10. Takes command line arguments specifiying the sweep index (1-20), the parameter sweep name (i.e. KnowledgeRatio), the ground truth regime (lower case, with variant label, i.e. asynchronous_0), the test number (1-20), and the instance number (which reservoir/ODE instantiation, 1-40). It will plot three figures, one for each model (ODE, Standard, Hybrid), showing the x phase component trajectories over the first 150 seconds of the test prediction. alter the parameter 't' on line 41 to change how many time steps to plot (dt=0.1). Individual trajectories may vary from those reported in the supplementary information if the original data is not used due to default random seed use as discussed above.



